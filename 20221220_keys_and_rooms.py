'''
Leetcode problem 841

Keys and Rooms
There are n rooms labeled from 0 to n - 1 and all the rooms are locked except for room 0. Your goal is to visit all the rooms. However, you cannot enter a locked room without having its key.

When you visit a room, you may find a set of distinct keys in it. Each key has a number on it, denoting which room it unlocks, and you can take all of them with you to unlock the other rooms.

Given an array rooms where rooms[i] is the set of keys that you can obtain if you visited room i, return true if you can visit all the rooms, or false otherwise.

 

Example 1:

Input: rooms = [[1],[2],[3],[]]
Output: true
Explanation: 
We visit room 0 and pick up key 1.
We then visit room 1 and pick up key 2.
We then visit room 2 and pick up key 3.
We then visit room 3.
Since we were able to visit every room, we return true.
Example 2:

Input: rooms = [[1,3],[3,0,1],[2],[0]]
Output: false
Explanation: We can not enter room number 2 since the only key that unlocks it is in that room.
 

Constraints:

n == rooms.length
2 <= n <= 1000
0 <= rooms[i].length <= 1000
1 <= sum(rooms[i].length) <= 3000
0 <= rooms[i][j] < n
All the values of rooms[i] are unique.

Status: ACCEPTED
'''

class Solution:
    def visit_room(self, rooms, key, keys):
        for room_key in rooms[key]:
            if room_key not in keys:
                keys.append(room_key)
                self.visit_room(rooms, room_key, keys)
        return keys
    
    def canVisitAllRooms(self, rooms) -> bool:
        rooms_length = len(rooms)
        keys = [0]
        for i in range(rooms_length):
            if i in keys:
                self.visit_room(rooms, i, keys)
        if len(keys) == rooms_length:
            return True
        return False
    
if __name__ == "__main__":
    solution = Solution()
    print(solution.canVisitAllRooms([[1],[2],[3],[]]))
    print(solution.canVisitAllRooms([[1,3],[3,0,1],[2],[0]]))
    print(solution.canVisitAllRooms([[6,7,8],[5,4,9],[],[8],[4],[],[1,9,2,3],[7],[6,5],[2,3,1]]))
    print(solution.canVisitAllRooms([[13],[15,29,22],[5,18,9],[7],[27],[27],[6,28],[26],[34],[1,44,11],[8,36],[17,35],[11,45,46,10,49],
    [19,38,47,39],[20,30],[34],[32,31],[25,19,21,29],[36],[],[38],[2,13,17,47],[12],[49,46],[],[40],[],[39,16,24],[24,41],[14,3,40],[14,43],
    [],[3,20,23],[37,48],[6,10],[26,1,4],[],[41,45],[23,33],[],[22,18,37],[4,33,43],[28,31,42],[30,48],[16,35],[5,8,44],[2,25],[9,21,42],[7,12,32],[]]))
    print(solution.canVisitAllRooms([[988],[785,827,950,458],[],[814,844],[317,374,825],[],[203],[462],[279,413,131,343],[495],[598],[],[44,836],[435,896,966,636],
    [999],[169,735],[438,978,408,891],[],[242,343],[285,821,835],[402,588],[],[912],[804,831,62],[823],[693],[348],[732],[307,728],[],[],[],[182],[800],[456],[],
    [758,915,176],[51,562],[35,166,125,300],[388,165,819],[679],[90,54,863],[452,654],[620,765,886,941],[204],[155],[120,318],[],[],[237],[],[180,189,685],[430,886],
    [],[282],[167,514],[168],[525,563,623,951],[],[294,961],[281,489],[154,707,463],[768],[],[832],[652,843,957],[211],[],[535,7,697],[],[45,58,224],[86,456,203],
    [309,755],[],[953,1,112],[662,369,861],[328,561,366],[259,507],[503],[575,594],[57,640,649],[238,541,204],[328],[187,260,891,764],[742],[164],[388],[862,865,94],
    [236,336],[310,420,92,376,399,504,837],[618,113],[43],[810],[],[709],[],[647],[129,286],[426],[578],[666,858,394],[973],[339,925,278],[586],[],[480,258,439,466,912],
    [135,471],[551,469,522],[253,391,232],[698],[635],[196],[681],[483],[268,955],[124],[197,629,632,983,845,847],[747,699],[],[],[],[93,185,945,415,512],[56,170,772,845],
    [917,183,321,425,828],[418,806,807],[549,774,674],[],[270,698,244,644],[87,37],[32,863,88,292],[641,718,856,57,344],[5],[712,234],[467],[],[],[151],[382,346,778],
    [417,817],[1],[499,607,835,797],[100,524,759],[507,602,90,167],[],[867],[],[14],[171,399,238,646],[263,91,303,370],[67,571,536,657,878],[377],[22,337,873],[235],
    [130,678,200,520,598,703],[554,302,790],[692],[351,225],[],[41,109,480,816],[610,329,502],[494,792,26,382],[113,831],[],[741,542,758,981],[107],[191],[634,49,695,718],
    [360],[315,690],[929],[934,985],[246],[],[50,72,257,359,843],[207,392],[],[304,574,651,106,152,848,916,947],[103,378,687],[202,834,114,138,809],[937,20,401],[330,444],
    [587,515],[],[144,395],[676],[564,721],[19,730,432,614,931],[548,445],[194,214,652],[55,503,60,260,612],[600,933,4,750],[439,909],[899],[],[14,737,342,414,939],
    [502,544,940],[174,573],[667],[201,385],[688,797],[284,942],[185],[980,781,857],[682,792],[406,149],[261],[949,921],[],[731],[553],[159,70],[922],[292,536,606],
    [347],[910,316],[264],[23,949],[670,468,894],[],[379],[560,775],[677,894,2],[306,816,553,604],[6,134],[540,93],[648,430],[811],[509,146],[909,762],[566,779,535,736],
    [],[140,396,42],[95],[103,190],[274],[268,824,377,693],[403,842],[521],[],[829,447],[61],[],[95,111,858],[],[243],[291],[78,384,893,420],[771,357,743],[],[108,368,572],
    [65,360,572,692,877],[432,753,928,766,892],[],[547,776],[821,932,150,311],[990,868],[550],[465],[],[515,740,872],[255,256],[46,159],[964],[363,19],[808,744],[270],
    [577,748],[738,339,889],[411],[362,171,648],[],[301],[874],[299],[60,358,52],[357,627],[256,631,320],[165,603,960],[297],[61,69,337],[274,402],[288,550,994],
    [41,709],[21,262,442,499],[247,611,240,491],[250,457,220],[749,960,564],[119],[441,374],[],[186,349],[38,211,383,488,10],[589],[324,656,245],[820,566,807],[223],[20],
    [440,613],[848],[472],[522],[630],[876,753],[719],[920,118,334,671],[261,436],[481,562,493],[486,905],[],[434,170,672],[920],[874],[901,948],[12,252,613,967,881],
    [174,358,362],[421,582,813,622,791],[492],[],[228,579],[609,676,798,140,166,318,967],[447],[534,352,467],[169],[],[243,991],[952,310],[122,379,476],[501,569],[998,584,930],
    [605],[259,296,901,990],[401,405,969],[181,722],[64],[],[17,668],[97,324],[672,887,202,633,906],[517,130],[],[568,601,624,755,800,591],[780,994],[281,517],[17,527],[],
    [354,581],[966],[640],[860,992,435],[725],[30,308],[451],[617],[],[39],[794],[537,767],[646,46],[726,853],[277,805],[424,593,664],[116],[394],[520,592,459,733],[684],
    [333,958],[],[],[385,628,325,642,729],[267,277,485,689],[],[645],[53,404],[604,660,763],[],[207],[245,455,717,121],[38,356,854],[9,156,53],[16],[52,470,658,895,96],
    [271,841],[],[482],[773,883,629],[830],[136,407,840],[86],[342,506],[452,466,481,922],[175],[163],[],[321,8,191],[109,866],[703],[],[389,661],[757,265],[],[425],[319,580],
    [],[87],[],[42,126,724,970,820],[71,608],[62,661,664],[309],[638,105,434,641,987],[916,75,449,470],[179,248],[650,419,827],[414,746,812],[179],[387],[139,825,868,254,540,808,900],
    [47],[11,141,511,956,964],[217,348,543,982],[],[],[225,700,822,850],[781,132,496,498],[59,593,879,846],[36,355,528,880,721,937],[163],[675,263,423],[428,654,840],[],
    [484,588,744,769,269,545],[583,71,494,556,884],[],[354,745,599],[],[121,125,849],[851,381,400,656],[359,929],[668,777],[],[350,653],[10,320,516],[32,251],[878,206,587],
    [410,924],[782],[955],[302,610],[639,824],[25,258,930,544],[422,828,938],[524],[847],[233,287],[627,686,773,946,983],[149],[16,570,903],[48,760],[651],[7,532,805,890,154,380,700],
    [],[228,389],[158,838],[23,269,424,732],[239,513],[280],[367,5,738],[340,431,680],[796,153,710,716],[266,440,688,893],[],[273,720,993],[445,82,490],[353,545,567,592],[969,815],
    [157,446],[82],[231],[2,55],[],[112,322,993],[],[475],[146,283,625,229],[37,102,590,907,288,616],[737],[341,854,784],[702,743],[924,317],[70,568],[],[89,143],[],[330,218],[665],
    [115],[615],[144],[849],[925],[278,639,771],[585],[889],[],[697,442,551],[716,99],[],[298,637,372],[760,995],[79,73,538,714,917],[621,691],[143,237,306,974],[227],[356,415,938],
    [759,375,859],[450],[44],[888,11,926],[],[903,902],[369,469,422],[412],[],[378,895],[464,696],[215,460,495,701],[546,295,752,935],[815,650],[762,173],[],[787,921,971],[177,283,812,910],
    [508,241],[],[408],[931,984],[290,978],[299,326],[631,774,799],[411,619,312,870],[28,818,477],[240,161,217,673,992],[65],[596],[91],[405],[],[8,142,995,484,767],[],[280],[248,155],
    [365,21,813],[64,772],[963],[871],[],[956,34],[766,881,246],[77,853],[22,530],[510,669],[622,981],[141,150,249],[513,636],[172,944,253],[123,335,911],[458,768],[127,673,546],
    [26,344],[94,15,373,393],[443,665,841,897,391,796],[478,666],[85,999,208],[327,712,882],[18,192,257,936],[206,352,519],[],[133,970],[975,48,479],[751,923,78,367],[],[],[823],[101],
    [209,264,368],[735],[],[],[],[88,461,473],[24,101,284,850,933],[600,887],[380,626,230,679],[289,156],[596],[136,580,117,294,677],[220,846,74],[160,913,923],[193],
    [106,208,649,974,390,403,532,628],[597,351],[],[81,325,395],[345],[291,501,997,127,355],[350,438],[555,455],[98,303,985,574,643],[152,832,885],[182,706,780],[307,36,691,818],
    [219,940],[117,789],[332,952],[742],[],[386],[493,882,314],[],[784],[],[297,880],[162,837],[],[681,794,554,690,888,953],[810],[728,115,313,597,702,968],[176,396,529,879],
    [84,856],[],[361,750,205,715],[584,855,289],[308,788],[576,83,129],[487,521,637],[468],[802,25],[105,706,811,859,192],[],[486,581,986],[157,561],[58,756,842],[791,826,247],
    [349,454,575],[947,81,907],[392,3,705],[],[708,488],[72,857],[],[69,871,66,662],[793,867],[316,911,164,704,927],[713],[591,139,276],[],[556,558],[],[345,273,976],[239,397],
    [475,526],[],[180,255],[],[694],[644,413],[844,965],[747,961],[],[531],[9,199,783],[33],[183,212,510],[],[],[633,799,621],[988],[100],[24,465,782],[],[806,826],[555],[194],
    [589,951],[128],[443,740],[623,989,290,460,904],[124,232,102,731],[647,659],[],[902,142],[213,286],[],[421,932],[473],[92,205,533],[267,919],[569,727],[428],[],[620,875],
    [118],[31,542],[869],[252,660],[131,188,329,996],[833,107,226],[733],[],[577,548],[770],[222,861,285,739],[],[265,450],[145,518,209],[119,563],[870,565,669,707],[943,852],
    [],[959],[892,883,977],[363,603,711],[601],[819,595,914],[313,111],[795,340],[229,331],[809],[417],[717],[160,416,31,120],[],[],[694,534],[],[233],[734],[364,483],[13,197,754],
    [865],[612,795],[],[333,429,492,145],[28,989],[137,567],[29,913],[595,701,958,525,658],[66,12,175],[138,979],[184,370],[],[128,471,945],[],[279,416,803],[802],[454],
    [334,739,315,653],[],[451,275],[45,151,47,168,943],[376,624,876],[153,271],[254,89,305,749],[213,336,528],[172,908],[939,193],[322],[573,505],[655,602],[272,976,147],
    [935],[754,829,918],[116,786,934],[541],[941,40],[],[68,477,187],[900,353],[576],[33,804],[276,836],[54,98],[201,474,714,571],[866,384,864],[914],[250,272,890],
    [671,231],[489,590,713],[],[462],[311,552,409],[],[148,982,427,725,833],[],[605,927],[],[685],[],[680,984],[104,346,498,736,184,216,457],[27,49,312,35],[96,689],
    [74,224,777],[123],[300,570,761],[453],[3,719],[],[638],[110],[431],[],[490,361],[],[776,221,341],[682,787],[],[491,745],[998],[699,751],[437,987,928],[],[614,873,607],
    [4,132,63,862],[485,683],[657,181],[293,543,608,319,559],[611,723],[73,76,537],[39,710],[249,459,869,500,518],[560,838],[76,407,464,896],[226,839],[390,778,944],[538],
    [398,674,433],[400],[418,527],[817],[56],[],[195],[729],[],[798],[512],[948],[926],[864,977,27],[436,803,371],[594],[962],[419,599,198,625],[539],[427,429,793],
    [423,476,720,242,769],[860],[],[],[506],[244,632],[],[675],[198,635],[326,968,785],[199,559,695,509,558],[899],[304],[83],[34],[],[85],[898],[539,765,957],[433,529,684,711],
    [293],[177],[479],[110,963,726],[40,186,779],[763,746],[962],[241,223,235],[748,683],[],[227],[855],[704,851],[579],[80],[323,904,971,834],[410,497],[15,670],[189,997],
    [884,448],[642],[],[],[29,547,655],[375],[162],[18],[77,582],[365,678],[212,449,761],[287,727,885,461],[295,409],[59,188,557],[30,161,373,877,222,756],
    [381,734,406,814,875],[444,686],[741],[305,770,619],[80,148,523],[],[75,775,783],[722,398],[347],[275],[122,216,790],[364,549],[715],[946,474],[533],[],
    [478,338,412],[366,104,788],[500,446,980],[531,126,583,585],[],[],[],[936],[496],[221,659,954],[178,215,441],[626],[251,552,973],[724],[195,687],[643,13,79,135,266],
    [519,801,397,437,472,618],[],[663,905],[314,327,586],[708],[210,448,158,386],[173,630],[530,487],[43,331,426],[898],[839,919,6],[463,752,298],[63,99,387],[332],[504,696],
    [],[616,975],[51,915],[615],[404],[214,634,972],[],[200,296,918,801,996],[230,282,950],[],[578,617,872,954],[730,959],[511,67],[764,965],[196,757],[942],[609,663],[667,526],
    [],[897],[],[133,137],[114,723],[84,393,134,236,323],[147,786,852,508],[565],[453,497],[],[372],[991],[97,523,906],[210],[972],[335,371,789,108,262],[301,514,219],
    [190,218,705,482],[822],[338,606],[234,505,908,979,50,383],[986],[516,68,830],[557],[645,178]]))